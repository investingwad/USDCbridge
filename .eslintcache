[{"/home/atul/Desktop/clone-folder/USDCbridge/src/ethComponent.js":"1","/home/atul/Desktop/clone-folder/USDCbridge/src/eostransaction.js":"2","/home/atul/Desktop/clone-folder/USDCbridge/src/abi.js":"3","/home/atul/Desktop/clone-folder/USDCbridge/src/index.js":"4","/home/atul/Desktop/clone-folder/USDCbridge/src/logic/reducers/user.reducer.js":"5","/home/atul/Desktop/clone-folder/USDCbridge/src/config.js":"6","/home/atul/Desktop/clone-folder/USDCbridge/src/eosComponent.js":"7"},{"size":7719,"mtime":1611564589870,"results":"8","hashOfConfig":"9"},{"size":7189,"mtime":1611559057275,"results":"10","hashOfConfig":"9"},{"size":23835,"mtime":1611562761346,"results":"11","hashOfConfig":"9"},{"size":627,"mtime":1609157382691,"results":"12","hashOfConfig":"9"},{"size":763,"mtime":1611558708452,"results":"13","hashOfConfig":"9"},{"size":299,"mtime":1611559569884,"results":"14","hashOfConfig":"9"},{"size":11569,"mtime":1611562577178,"results":"15","hashOfConfig":"9"},{"filePath":"16","messages":"17","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"19o9ehe",{"filePath":"18","messages":"19","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"20"},{"filePath":"21","messages":"22","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"23","messages":"24","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"25","messages":"26","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"27","messages":"28","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"29","messages":"30","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"/home/atul/Desktop/clone-folder/USDCbridge/src/ethComponent.js",["31","32","33"],"/home/atul/Desktop/clone-folder/USDCbridge/src/eostransaction.js",["34","35","36","37","38"],"import { useState, useEffect } from \"react\";\nimport WalletProvider from \"./walletProvider\";\nimport { Field, Form, Formik, ErrorMessage } from \"formik\";\nimport { useSelector } from \"react-redux\";\nimport * as Yup from \"yup\";\n//@ts-ignore\nimport EosApi from \"eosjs-api\";\nimport { contracts, eosEndpoint, tables } from \"./config\";\n\nconst options = {\n  httpEndpoint: eosEndpoint,\n};\nconst eos = EosApi(options);\n\nconst schema = Yup.object().shape({\n  value: Yup.number()\n    .required(\"Enter value of token\")\n    .test(\"lowAmount\", `Should be greater than 0`, (val) => parseInt(val) > 0),\n  token: Yup.string().required(\"Select a token type\"),\n});\n\nconst initialValues = {\n  value: \"\",\n  token: \"6,EUSDC\",\n};\n\nconst EosTransaction = (props) => {\n  const username = useSelector((state) => state.user.username);\n  const walletConnected = useSelector((state) => state.user.walletConnected);\n  const ethwalletConnected = useSelector(\n    (state) => state.address.ethWalletConnected\n  );\n  const [balances, setUserBalances] = useState([]);\n  const [tokenSymbol, setSymbols] = useState([\"6,EUSDC\"]);\n  const [loading, setLoading] = useState(false);\n  const [errorMsg, seterrorMsg] = useState(\"\");\n  const [successMsg, setsuccessMsg] = useState(\"\");\n\n  const { loggedIn } = props;\n  const getTokens = async () => {\n    let tokens = [];\n    const requests = await eos.getTableRows({\n      code: contracts.BRIDGE_CON,\n      scope: contracts.BRIDGE_CON,\n      table: tables.Symbols,\n      json: \"true\",\n    });\n    if (requests.rows.length) {\n      requests.rows.map((row) => {\n        tokens.push(row.dtoken.toString());\n      });\n    }\n    console.log(\"tokesn----\", tokens);\n    setSymbols(tokens);\n    return tokens;\n  };\n\n  const getBalance = async (tokens, account) => {\n    const userbal = [];\n    try {\n      if (tokens.length) {\n        console.log(\"username----\", account);\n        for (const symbol of tokens) {\n          let code;\n          let toAcc;\n          // if (symbol == \"4,DAPP\") {\n          //   code = \"dappservices\";\n          // } else {\n          code = contracts.TokenContract;\n          // }\n          const tokensData = {\n            code: code,\n            json: true,\n            limit: 1000,\n            scope: account,\n            table: tables.Accounts,\n            table_key: account,\n          };\n          console.log(\"tokensData----\", tokensData);\n          const responses = await fetch(\n            \"https://api.main.alohaeos.com/v1/chain/get_table_rows\",\n            {\n              method: \"post\",\n              body: JSON.stringify(tokensData),\n            }\n          );\n\n          const tokensdata = await responses.json();\n          console.log(\"respose----\", tokensdata);\n          if (tokensdata.rows.length) {\n            const balanceRow = tokensdata.rows.find(\n              (row) => row.balance.split(\" \")[1] == symbol.split(\",\")[1]\n            );\n            userbal.push(balanceRow.balance);\n          }\n        }\n        console.log(\"userbalance ---\", userbal);\n        setUserBalances(userbal);\n      }\n    } catch (e) {\n      console.log(\"errr---\", e);\n      setUserBalances(userbal);\n    }\n  };\n\n  useEffect(() => {\n    getTokens();\n    const getbal = async () => {\n      const tokens = await getTokens();\n      if (walletConnected && tokens.length) {\n        await getBalance(tokens, username);\n      }\n    };\n    if (loggedIn) {\n      getbal();\n    }\n    if (!loggedIn) {\n      setUserBalances([]);\n    }\n  }, [loggedIn]);\n\n  const handleTransfer = async (values) => {\n    try {\n      setLoading(true);\n      const { value, token } = values;\n      const wallet = WalletProvider.getWallet();\n      if (!walletConnected) {\n        seterrorMsg(\"Eos wallet is not connected\");\n      }\n      if (!ethwalletConnected) {\n        seterrorMsg(\"Ethereum wallet is not connected\");\n      }\n      if (!!wallet) {\n        let account;\n        let toAcc;\n        // if (token == \"4,DAPP\") {\n        //   account = \"dappservices\";\n        //   toAcc = contracts.EthContract;\n        // } else {\n        account = contracts.TokenContract;\n        toAcc = contracts.BRIDGE_CON;\n        // }\n        const result = await wallet.eosApi.transact(\n          {\n            actions: [\n              {\n                account: account,\n                name: \"transfer\",\n                authorization: [\n                  {\n                    actor: wallet.auth.accountName,\n                    permission: wallet.auth.permission,\n                  },\n                ],\n                data: {\n                  from: wallet.auth.accountName,\n                  to: toAcc,\n                  quantity: `${parseInt(value).toFixed(\n                    parseInt(token.split(\",\")[0])\n                  )} ${token.split(\",\")[1]} `,\n                  memo: `Transfer ${token.split(\",\")[1]} token`,\n                },\n              },\n            ],\n          },\n          {\n            broadcast: true,\n            blocksBehind: 3,\n            expireSeconds: 60,\n          }\n        );\n        if (result) {\n          setLoading(false);\n          setsuccessMsg(\"Transaction Success\");\n          seterrorMsg(\"\");\n        }\n      } else {\n        setLoading(false);\n      }\n    } catch (e) {\n      console.log(\"error in treansferinng----\", JSON.parse(JSON.stringify(e)));\n      seterrorMsg(e.message);\n      setLoading(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"form-container\">\n      <div>4. Send Tokens EOS to Ethereum</div>\n      <div className=\"login\">\n        <div className=\"register\">\n          <Formik\n            initialValues={initialValues}\n            validationSchema={schema}\n            onSubmit={handleTransfer}\n          >\n            <Form>\n              {balances.map((balance) => (\n                <div className=\"userbalance\">{balance}</div>\n              ))}\n              <div>\n                <Field name=\"value\" placeholder=\"enter amount\" />\n              </div>\n              <div>\n                <ErrorMessage name=\"value\" className=\"error\" />\n              </div>\n              <div>\n                <Field as=\"select\" name=\"token\">\n                  {/* {tokenSymbol.map((sym) => (\n                    <option name=\"token\" value={sym}>\n                      {sym.split(\",\")[1]}\n                    </option>\n                  ))} */}\n                  <option value=\"6,EUSDC\">EUSDC</option>\n                  <option value=\"6,DAI\">DAI</option>\n                  {/* <option value=\"4,DAPP\">DAPP</option> */}\n                </Field>\n              </div>\n              <div>\n                <ErrorMessage name=\"token\" className=\"error\" />\n              </div>\n              <div>\n                <button\n                  type=\"submit\"\n                  className=\"registerbtn\"\n                  disabled={loading}\n                >\n                  {loading ? \"Sending Token\" : \"Send Token\"}\n                </button>\n              </div>\n            </Form>\n          </Formik>\n        </div>\n      </div>\n      {errorMsg ? (\n        <div className=\"error\">{errorMsg}</div>\n      ) : (\n        <div className=\"success\">{successMsg}</div>\n      )}\n    </div>\n  );\n};\n\nexport default EosTransaction;\n","/home/atul/Desktop/clone-folder/USDCbridge/src/abi.js",[],"/home/atul/Desktop/clone-folder/USDCbridge/src/index.js",[],"/home/atul/Desktop/clone-folder/USDCbridge/src/logic/reducers/user.reducer.js",[],"/home/atul/Desktop/clone-folder/USDCbridge/src/config.js",[],"/home/atul/Desktop/clone-folder/USDCbridge/src/eosComponent.js",["39","40"],{"ruleId":"41","severity":1,"message":"42","line":14,"column":23,"nodeType":"43","messageId":"44","endLine":14,"endColumn":34},{"ruleId":"41","severity":1,"message":"45","line":40,"column":9,"nodeType":"43","messageId":"44","endLine":40,"endColumn":24},{"ruleId":"41","severity":1,"message":"46","line":42,"column":9,"nodeType":"43","messageId":"44","endLine":42,"endColumn":27},{"ruleId":"41","severity":1,"message":"47","line":34,"column":10,"nodeType":"43","messageId":"44","endLine":34,"endColumn":21},{"ruleId":"48","severity":1,"message":"49","line":49,"column":31,"nodeType":"50","messageId":"51","endLine":49,"endColumn":33},{"ruleId":"41","severity":1,"message":"52","line":65,"column":15,"nodeType":"43","messageId":"44","endLine":65,"endColumn":20},{"ruleId":"53","severity":1,"message":"54","line":92,"column":50,"nodeType":"55","messageId":"56","endLine":92,"endColumn":52},{"ruleId":"57","severity":1,"message":"58","line":120,"column":6,"nodeType":"59","endLine":120,"endColumn":16,"suggestions":"60"},{"ruleId":"41","severity":1,"message":"61","line":103,"column":13,"nodeType":"43","messageId":"44","endLine":103,"endColumn":22},{"ruleId":"41","severity":1,"message":"61","line":175,"column":13,"nodeType":"43","messageId":"44","endLine":175,"endColumn":22},"no-unused-vars","'useDispatch' is defined but never used.","Identifier","unusedVar","'walletConnected' is assigned a value but never used.","'ethwalletConnected' is assigned a value but never used.","'tokenSymbol' is assigned a value but never used.","array-callback-return","Array.prototype.map() expects a return value from arrow function.","ArrowFunctionExpression","expectedInside","'toAcc' is defined but never used.","eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'username' and 'walletConnected'. Either include them or remove the dependency array.","ArrayExpression",["62"],"'eosAmount' is assigned a value but never used.",{"desc":"63","fix":"64"},"Update the dependencies array to be: [loggedIn, username, walletConnected]",{"range":"65","text":"66"},[3454,3464],"[loggedIn, username, walletConnected]"]